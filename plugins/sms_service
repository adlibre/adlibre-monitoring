#!/bin/bash
#
# Email Alert via SMS / Email.
#
# Ultra compact alert format in 160 chars!
#
# Andrew Cutler 2008-03-04
#

CONTACTEMAIL=$ICINGA_CONTACTEMAIL
SERVICESTATE=$ICINGA_SERVICESTATE
SERVICEDESC=$ICINGA_SERVICEDESC
HOSTNAME=$ICINGA_HOSTNAME
SERVICEOUTPUT=$ICINGA_SERVICEOUTPUT
TIMEDATE="$ICINGA_TIME $ICINGA_DATE"

echo -e "To: ${CONTACTEMAIL}\r
Subject: Service ${SERVICESTATE} - ${HOSTNAME}\r
\r
${SERVICESTATE:0:8}\r
${HOSTNAME:0:16}\r
${SERVICEDESC:0:32}\r
${SERVICEOUTPUT:0:80}\r
${TIMEDATE:0:20}" | /usr/sbin/sendmail -i -f nagios@`hostname` ${CONTACTEMAIL}
